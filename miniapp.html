<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NSFW Adventure App</title>
    <link href="https://unpkg.com/tailwindcss@^2/dist/tailwind.min.css" rel="stylesheet">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: 'SF Pro Display', sans-serif;
            background: #1a0e2a;
            color: #d4af37;
            height: 100vh;
            overflow-y: auto;
            background: radial-gradient(circle, #1a0e2a 0%, #2d1b40 70%, #1a0e2a 100%);
        }
        .header {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            background: rgba(26, 14, 42, 0.95);
            backdrop-filter: blur(10px);
            padding: 10px;
            z-index: 1000;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid #a33bff;
        }
        .token-display {
            display: flex;
            align-items: center;
            gap: 8px;
            background: linear-gradient(135deg, rgba(45, 28, 72, 0.9), rgba(107, 61, 141, 0.9));
            border-radius: 15px;
            padding: 8px 12px;
            backdrop-filter: blur(10px);
            box-shadow: 0 0 10px rgba(163, 59, 255, 0.5);
        }
        .token-display .fire-icon {
            font-size: 20px;
            animation: flicker 1.5s infinite;
        }
        .subscription-status {
            font-size: 14px;
            color: #e0b68a;
            font-family: 'SF Pro Text', sans-serif;
            font-weight: 500;
            margin-top: 5px;
        }
        .language-button {
            background: linear-gradient(90deg, #2a1b3d, #4b2e6e);
            border-radius: 10px;
            padding: 6px 10px;
            font-family: 'SF Pro Display', sans-serif;
            font-weight: 600;
            font-size: 14px;
            border: none;
            color: #e6d5ff;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 3px;
        }
        .language-button:hover {
            background: linear-gradient(90deg, #4b2e6e, #2a1b3d);
            transform: scale(1.1);
        }
        .card {
            background: linear-gradient(145deg, #2d1b40, #3d285a);
            border-radius: 10px;
            padding: 5px;
            margin: 0;
            width: 100%;
            text-align: center;
            border: 1px solid #a33bff;
            box-shadow: 0 0 15px rgba(163, 59, 255, 0.4);
            transition: transform 0.3s ease;
        }
        .card:hover {
            transform: translateY(-5px);
        }
        .sub-card {
            background: linear-gradient(145deg, #2d1b40, #3d285a);
            border-radius: 10px;
            padding: 5px;
            margin: 0;
            width: 100%;
            text-align: center;
            border: 1px solid #a33bff;
            box-shadow: 0 0 15px rgba(163, 59, 255, 0.4);
            transition: transform 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 5px;
        }
        .sub-card:hover {
            transform: translateY(-5px);
        }
        .sub-card.selected {
            border-color: #ff00ff;
            box-shadow: 0 0 20px #ff00ff;
        }
        .product-image {
            height: 150px;
            width: 150px;
            background-size: cover;
            background-position: center;
            border-radius: 5px;
            margin: 0 auto 5px;
        }
        .sub-image {
            height: 50px;
            width: 50px;
            background-size: cover;
            background-position: center;
            border-radius: 5px;
        }
        .custom-button {
            background: linear-gradient(90deg, #4b2e6e, #2a1b3d);
            border-radius: 8px;
            padding: 8px 12px;
            font-family: 'SF Pro Display', sans-serif;
            font-weight: 600;
            font-size: 14px;
            border: none;
            color: #e6d5ff;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 5px;
            margin: 2px auto;
        }
        .custom-button:hover {
            background: linear-gradient(90deg, #2a1b3d, #4b2e6e);
            transform: scale(1.05);
        }
        .buy-button {
            background: linear-gradient(90deg, #4b2e6e, #2a1b3d);
            border-radius: 8px;
            padding: 8px 12px;
            font-family: 'SF Pro Display', sans-serif;
            font-weight: 600;
            font-size: 14px;
            border: none;
            color: #e6d5ff;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 5px;
            margin: 2px auto;
            width: 100%;
        }
        .buy-button:hover {
            background: linear-gradient(90deg, #2a1b3d, #4b2e6e);
            transform: scale(1.05);
        }
        .neon-text {
            font-family: 'Monoton', cursive;
            color: #e6e6e6;
            font-weight: 400;
            text-shadow: 0 0 10px rgba(163, 59, 255, 0.8), 0 0 20px rgba(163, 59, 255, 0.5);
            animation: neonFlicker 2s infinite;
        }
        h1 {
            font-family: 'SF Pro Display', sans-serif;
            color: #e6e6e6;
            text-shadow: 0 0 10px rgba(163, 59, 255, 0.8), 0 0 20px rgba(163, 59, 255, 0.5);
            font-size: 2.5rem;
            margin: 10px 0;
        }
        h2, h3 {
            font-family: 'Monoton', cursive;
            color: #e6e6e6;
            font-weight: 400;
            text-shadow: 0 0 10px rgba(163, 59, 255, 0.8), 0 0 20px rgba(163, 59, 255, 0.5);
            font-size: 1.5rem;
            margin: 5px 0;
        }
        p {
            font-family: 'SF Pro Text', sans-serif;
            line-height: 1.6;
            color: #c8b8e0;
            opacity: 0.9;
            font-size: 0.9rem;
            margin: 2px 0;
        }
        .content-section {
            padding-top: 80px;
            padding-bottom: 60px;
            margin: 0;
            padding: 0;
        }
        .category-buttons {
            position: fixed;
            bottom: 10px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 5px;
            z-index: 1000;
        }
        .modal {
            background: rgba(13, 8, 22, 0.95);
            backdrop-filter: blur(10px);
        }
        .subscription-details {
            margin: 0;
            padding: 5px;
            background: linear-gradient(145deg, #2e204d, #1f1733);
            border-radius: 10px;
            border: 1px solid #a33bff;
            box-shadow: 0 0 20px rgba(163, 59, 255, 0.4);
            display: block;
        }
        .details-header {
            font-family: 'Monoton', cursive;
            color: #e6e6e6;
            font-size: 20px;
            text-shadow: 0 0 10px rgba(163, 59, 255, 0.8);
            margin: 2px 0;
        }
        .details-content p {
            margin: 2px 0;
        }
        .confirm-modal-content {
            background: linear-gradient(145deg, #2e204d, #1f1733);
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 0 20px rgba(163, 59, 255, 0.4);
            backdrop-filter: blur(10px);
            border: 1px solid #a33bff;
            width: 90%;
            max-width: 350px;
        }
        .discount {
            color: #e06666;
            text-decoration: line-through;
            margin-left: 5px;
            font-family: 'SF Pro Text', sans-serif;
        }
        @media (max-width: 640px) {
            .card {
                max-width: 180px;
            }
            .sub-card {
                max-width: 280px;
            }
            .product-image {
                height: 130px;
                width: 130px;
            }
            .sub-image {
                height: 40px;
                width: 40px;
            }
            h1 {
                font-size: 2rem;
            }
            h2, h3 {
                font-size: 1.25rem;
            }
            p {
                font-size: 0.8rem;
            }
            .custom-button, .buy-button {
                padding: 6px 10px;
                font-size: 12px;
            }
        }
        @keyframes flicker {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }
        @keyframes neonFlicker {
            0%, 100% { text-shadow: 0 0 10px rgba(163, 59, 255, 0.8), 0 0 20px rgba(163, 59, 255, 0.5); }
            50% { text-shadow: 0 0 15px rgba(163, 59, 255, 1), 0 0 25px rgba(163, 59, 255, 0.7); }
        }
    </style>
    <link href="https://fonts.googleapis.com/css2?family=SF+Pro+Display:wght@400;600&family=SF+Pro+Text:wght@400;500&family=Monoton&display=swap" rel="stylesheet">
</head>
<body class="flex flex-col items-center">
    <div class="header">
        <button id="languageBtn" class="language-button" onclick="toggleLanguage()">
            <span id="currentFlag"></span>
            <span id="languageText"></span>
        </button>
        <div class="token-display">
            <span id="tokenCount" class="text-xl font-bold"></span>
            <span class="fire-icon">üî•</span>
            <button id="addTokensBtn" class="custom-button p-1">
                <span>+</span>
            </button>
        </div>
    </div>

    <div id="mainContent" class="w-full max-w-[95%]">
        <h1 id="welcomeTitle" class="text-3xl font-bold text-center mt-4 mb-2"></h1>
        <div id="subscriptionStatus" class="text-center subscription-status mb-2"></div>
        <div id="limitsStatus" class="text-center subscription-status hidden mb-2"></div>

        <div id="scenariosSection">
            <h2 id="scenariosTitle" class="text-xl font-semibold text-center mb-2"></h2>
            <div class="grid grid-cols-2 gap-0 p-0 m-0">
                <div class="card">
                    <div class="product-image" style="background-image: url('https://i.imgur.com/PLFfgE3.png');"></div>
                    <h3 id="scenario1Title" class="text-md font-medium"></h3>
                    <p id="scenario1Desc" class="text-xs mt-1"></p>
                    <button class="custom-button mt-2" onclick="selectScenario(1)">
                        <span>üî•</span> <span id="scenario1Btn"></span>
                    </button>
                </div>
                <div class="card">
                    <div class="product-image" style="background-image: url('https://i.imgur.com/x5qpjFu.png');"></div>
                    <h3 id="scenario2Title" class="text-md font-medium"></h3>
                    <p id="scenario2Desc" class="text-xs mt-1"></p>
                    <button class="custom-button mt-2" onclick="selectScenario(2)">
                        <span>üî•</span> <span id="scenario2Btn"></span>
                    </button>
                </div>
                <div class="card">
                    <div class="product-image" style="background-image: url('https://i.imgur.com/Y0kIyVQ.png');"></div>
                    <h3 id="scenario3Title" class="text-md font-medium"></h3>
                    <p id="scenario3Desc" class="text-xs mt-1"></p>
                    <button class="custom-button mt-2" onclick="selectScenario(3)">
                        <span>üî•</span> <span id="scenario3Btn"></span>
                    </button>
                </div>
                <div class="card">
                    <div class="product-image" style="background-image: url('https://i.imgur.com/vlsALsH.png');"></div>
                    <h3 id="scenario4Title" class="text-md font-medium"></h3>
                    <p id="scenario4Desc" class="text-xs mt-1"></p>
                    <button class="custom-button mt-2" onclick="selectScenario(4)">
                        <span>üî•</span> <span id="scenario4Btn"></span>
                    </button>
                </div>
            </div>
        </div>

        <div id="subscriptionsSection" class="hidden">
            <h2 id="subscriptionsTitle" class="text-xl font-semibold text-center mb-2"></h2>
            <div id="subscriptionDetails" class="subscription-details">
                <h3 id="detailsHeader" class="details-header"></h3>
                <div id="subscriptionsDesc" class="details-content">
                    <p>Premium Benefits üî•‚ú®</p>
                    <p id="photoLimitText">New Limit: 50 Photos/Day + Unlimited Chat! üí¨üíÉ</p>
                    <p>Dress Better üåü</p>
                    <p>Reply Faster ‚ö°</p>
                    <p>Enhanced Image Quality üé®</p>
                    <p>Priority Scenarios Access üöÄ</p>
                </div>
            </div>
            <div class="grid grid-cols-2 gap-0 p-0 m-0">
                <div class="sub-card" onclick="selectSubscription(1)">
                    <div class="sub-image" style="background: #2d1b40;"></div>
                    <div>
                        <h3 id="sub1Day" class="neon-text text-md font-medium"></h3>
                        <p class="text-xs">$2.00</p>
                    </div>
                </div>
                <div class="sub-card" onclick="selectSubscription(2)">
                    <div class="sub-image" style="background: #2d1b40;"></div>
                    <div>
                        <h3 id="sub3Days" class="neon-text text-md font-medium"></h3>
                        <p class="text-xs">$5.00</p>
                    </div>
                </div>
                <div class="sub-card" onclick="selectSubscription(3)">
                    <div class="sub-image" style="background: #2d1b40;"></div>
                    <div>
                        <h3 id="sub1Week" class="neon-text text-md font-medium"></h3>
                        <p class="text-xs">$13.00</p>
                    </div>
                </div>
                <div class="sub-card" onclick="selectSubscription(4)">
                    <div class="sub-image" style="background: #2d1b40;"></div>
                    <div>
                        <h3 id="sub1Month" class="neon-text text-md font-medium"></h3>
                        <p class="text-xs">$25.00</p>
                    </div>
                </div>
                <div class="sub-card" onclick="selectSubscription(5)">
                    <div class="sub-image" style="background: #2d1b40;"></div>
                    <div>
                        <h3 id="sub3Months" class="neon-text text-md font-medium"></h3>
                        <p class="text-xs">$70.00</p>
                    </div>
                </div>
                <div class="sub-card" onclick="selectSubscription(6)">
                    <div class="sub-image" style="background: #2d1b40;"></div>
                    <div>
                        <h3 id="subForever" class="neon-text text-md font-medium"></h3>
                        <p class="text-xs">$50.00</p>
                    </div>
                </div>
                <div class="sub-card" onclick="selectSubscription(7)">
                    <div class="sub-image" style="background: #2d1b40;"></div>
                    <div>
                        <h3 id="subDeluxe" class="neon-text text-md font-medium"></h3>
                        <p class="text-xs">$100.00</p>
                    </div>
                </div>
            </div>
            <button id="buySubscriptionBtn" class="buy-button mt-2" onclick="buySelectedSubscription()">
                <span id="buyBtnText"></span>
            </button>
        </div>

        <div id="currencySection" class="hidden">
            <h2 id="currencyTitle" class="text-xl font-semibold text-center mb-2"></h2>
            <p id="currencyBalanceText" class="text-center text-sm mb-2"></p>
            <div class="grid grid-cols-2 gap-0 p-0 m-0">
                <div class="card">
                    <div class="product-image" style="background-image: url('https://i.imgur.com/2MtgJl7.png');"></div>
                    <h3 id="smallPack" class="neon-text text-md"></h3>
                    <p id="smallPackDesc" class="text-xs mt-1"></p>
                    <button class="custom-button mt-2" onclick="buyTokens(100, 6)">
                        <span id="buyBtnSmallPack"></span>
                    </button>
                    <p class="text-gray-400 text-xs mt-1">$10<span class="discount">$6</span></p>
                </div>
                <div class="card">
                    <div class="product-image" style="background-image: url('https://i.imgur.com/2HWxUMb.png');"></div>
                    <h3 id="mediumPack" class="neon-text text-md"></h3>
                    <p id="mediumPackDesc" class="text-xs mt-1"></p>
                    <button class="custom-button mt-2" onclick="buyTokens(200, 12)">
                        <span id="buyBtnMediumPack"></span>
                    </button>
                    <p class="text-gray-400 text-xs mt-1">$20<span class="discount">$12</span></p>
                </div>
                <div class="card">
                    <div class="product-image" style="background-image: url('https://i.imgur.com/xSJRMNo.png');"></div>
                    <h3 id="largePack" class="neon-text text-md"></h3>
                    <p id="largePackDesc" class="text-xs mt-1"></p>
                    <button class="custom-button mt-2" onclick="buyTokens(500, 25)">
                        <span id="buyBtnLargePack"></span>
                    </button>
                    <p class="text-gray-400 text-xs mt-1">$30<span class="discount">$25</span></p>
                </div>
                <div class="card">
                    <div class="product-image" style="background-image: url('https://i.imgur.com/rg8546H.png');"></div>
                    <h3 id="megaPack" class="neon-text text-md"></h3>
                    <p id="megaPackDesc" class="text-xs mt-1"></p>
                    <button class="custom-button mt-2" onclick="buyTokens(1000, 45)">
                        <span id="buyBtnMegaPack"></span>
                    </button>
                    <p class="text-gray-400 text-xs mt-1">$60<span class="discount">$45</span></p>
                </div>
            </div>
        </div>
    </div>

    <div class="category-buttons">
        <button id="scenariosBtn" class="custom-button" onclick="showSection('scenariosSection')">
            <span>üé¨</span> <span id="scenariosBtnText"></span>
        </button>
        <button id="subscriptionsBtn" class="custom-button" onclick="showSection('subscriptionsSection')">
            <span>üí∞</span> <span id="subscriptionsBtnText"></span>
        </button>
        <button id="currencyBtn" class="custom-button" onclick="showSection('currencySection')">
            <span>üî•</span> <span id="currencyBtnText"></span>
        </button>
    </div>

    <div id="languageModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center hidden">
        <div class="confirm-modal-content">
            <h3 id="languageTitle" class="text-2xl font-bold mb-4"></h3>
            <button class="custom-button mb-2 w-full" onclick="setLanguage('en')">
                <span>üá¨üáß</span> English
            </button>
            <button class="custom-button mb-2 w-full" onclick="setLanguage('ru')">
                <span>üá∑üá∫</span> –†—É—Å—Å–∫–∏–π
            </button>
            <button class="custom-button bg-red-600 hover:bg-red-700 w-full" onclick="closeLanguageModal()">
                <span>‚úñ</span> <span id="closeBtnText"></span>
            </button>
        </div>
    </div>

    <div id="confirmModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center hidden">
        <div class="confirm-modal-content">
            <h3 id="confirmTitle" class="text-2xl font-bold mb-4"></h3>
            <p id="confirmText" class="mb-4"></p>
            <div class="flex flex-col gap-2">
                <button id="confirmBtn" class="custom-button bg-green-600 hover:bg-green-700 w-full"></button>
                <button id="cancelBtn" class="custom-button bg-red-600 hover:bg-red-700 w-full"></button>
            </div>
        </div>
    </div>

    <script>
        const tg = window.Telegram.WebApp;
        tg.ready();
        tg.expand();

        const userData = {
            user1: { fires: 0, subscriptionDaysLeft: 0, photoLimit: 0, dailyPhotoCount: 0 },
            user2: { fires: 0, subscriptionDaysLeft: 0, photoLimit: 0, dailyPhotoCount: 0 },
        };

        let currentUser = 'user1';
        let tokens = userData[currentUser].fires;
        let maxTokens = 100;
        const scenarios = [];
        let language = 'en';
        let subscriptionDaysLeft = userData[currentUser].subscriptionDaysLeft;
        let photoLimit = userData[currentUser].photoLimit;
        let dailyPhotoCount = userData[currentUser].dailyPhotoCount;
        let selectedPlan = null;

        const translations = {
            en: {
                welcome: 'Unleash Your Fantasies! üí´',
                scenarios: 'Scenarios',
                subscriptions: 'Premium Subscriptions',
                currency: 'Currency',
                languages: 'Languages',
                scenario1Title: 'Tutor Asleep',
                scenario1Desc: 'You enter her home, door ajar, finding her naked and dreaming of you. Wake her with a sinful touch! üòà',
                scenario1Btn: 'Unlock (100 Fires)',
                scenario2Title: 'Teacher After School',
                scenario2Desc: 'Alone with her to fix grades, her tight skirt teases as she bends over. üî•',
                scenario2Btn: 'Unlock (100 Fires)',
                scenario3Title: 'Policewoman Stop',
                scenario3Desc: 'She pulls you over in the wild, no license‚Äîher smirk promises a naughty punishment! üíã',
                scenario3Btn: 'Unlock (100 Fires)',
                scenario4Title: 'Helping Friend',
                scenario4Desc: 'Her computer‚Äôs stuck, and her shy glances turn into wild invites as you lean in. üòè',
                scenario4Btn: 'Unlock (100 Fires)',
                detailsHeader: 'Premium Benefits',
                subscriptionsDesc: 'Premium Benefits üî•‚ú®\nNew Limit: 50 Photos/Day + Unlimited Chat! üí¨üíÉ\nDress Better üåü\nReply Faster ‚ö°\nEnhanced Image Quality üé®\nPriority Scenarios Access üöÄ',
                subscriptionsDescDeluxe: 'Premium Benefits üî•‚ú®\nNew Limit: Unlimited Photos/Day + Unlimited Chat! üí¨üíÉ\nDress Better üåü\nReply Faster ‚ö°\nEnhanced Image Quality üé®\nPriority Scenarios Access üöÄ',
                sub1Day: '1 Day',
                sub3Days: '3 Days',
                sub1Week: '1 Week',
                sub1Month: '1 Month +30üî• Fires',
                sub3Months: '3 Months +100üî• Fires',
                subForever: 'Forever +200üî• Fires',
                subDeluxe: 'Deluxe (Unlimited) +500üî• Fires',
                buyBtn: 'Buy Subscription',
                buyBtnSmallPack: 'Buy for $6',
                buyBtnMediumPack: 'Buy for $12',
                buyBtnLargePack: 'Buy for $25',
                buyBtnMegaPack: 'Buy for $45',
                currencyBalance: 'Your current balance: ',
                smallPack: 'Small Pack',
                smallPackDesc: 'A quick boost with 100üî• Fires! üöÄ',
                mediumPack: 'Medium Pack',
                mediumPackDesc: 'Fuel your fantasies with 200üî• Fires! üí•',
                largePack: 'Large Pack',
                largePackDesc: 'Unleash the heat with 500üî• Fires! üî•',
                megaPack: 'Mega Pack',
                megaPackDesc: 'Go all out with 1000üî• Fires! üåü',
                languageTitle: 'Select Language',
                closeBtn: 'Close',
                confirmUnlock: 'Confirm Unlock',
                notEnoughFires: 'Not Enough Fires!',
                missingFires: amount => `You need ${amount} more Fires!`,
                buyFiresBtn: 'Buy Fires',
                cancelBtn: 'Cancel',
                scenarioUnlock: scenarioId => `Scenario "${['Tutor Asleep', 'Teacher After School', 'Policewoman Stop', 'Helping Friend'][scenarioId - 1]}" unlocked! Enjoy! üòè`,
                buyTokensMsg: (amount, price) => `You bought ${amount} Fires for $${price}! Dive in! üòà`,
                buySubMsg: (price, bonus) => `Subscription activated for $${price}! ${bonus > 0 ? `+${bonus} Fires bonus! ` : ''}Enjoy! üíã`,
                maxTokensMsg: max => `Maximum limit of ${max} Fires reached!`,
                languageSetMsg: 'Language set to English!'
            },
            ru: {
                welcome: '–†–∞—Å–∫—Ä–æ–π —Å–≤–æ–∏ —Ñ–∞–Ω—Ç–∞–∑–∏–∏! üí´',
                scenarios: '–°—Ü–µ–Ω–∞—Ä–∏–∏',
                subscriptions: '–ü—Ä–µ–º–∏—É–º –ø–æ–¥–ø–∏—Å–∫–∏',
                currency: '–í–∞–ª—é—Ç–∞',
                languages: '–Ø–∑—ã–∫–∏',
                scenario1Title: '–°–ø—è—â–∏–π —Ä–µ–ø–µ—Ç–∏—Ç–æ—Ä',
                scenario1Desc: '–¢—ã –∑–∞—Ö–æ–¥–∏—à—å –∫ –Ω–µ–π –¥–æ–º–æ–π, –¥–≤–µ—Ä—å –ø—Ä–∏–æ—Ç–∫—Ä—ã—Ç–∞, –æ–Ω–∞ —Å–ø–∏—Ç –≥–æ–ª–∞—è –∏ –≤–∏–¥–∏—Ç —Ç–µ–±—è –≤–æ —Å–Ω–µ. –†–∞–∑–±—É–¥–∏ –µ—ë –≥—Ä–µ—Ö–æ–≤–Ω—ã–º –ø—Ä–∏–∫–æ—Å–Ω–æ–≤–µ–Ω–∏–µ–º! üòà',
                scenario1Btn: '–†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å (100 –æ–≥–Ω–µ–π)',
                scenario2Title: '–£—á–∏—Ç–µ–ª—å–Ω–∏—Ü–∞ –ø–æ—Å–ª–µ —É—Ä–æ–∫–æ–≤',
                scenario2Desc: '–ù–∞–µ–¥–∏–Ω–µ —Å –Ω–µ–π —Ä–∞–¥–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –æ—Ü–µ–Ω–æ–∫, –µ—ë –æ–±—Ç—è–≥–∏–≤–∞—é—â–∞—è —é–±–∫–∞ –¥—Ä–∞–∑–Ω–∏—Ç, –∫–æ–≥–¥–∞ –æ–Ω–∞ –Ω–∞–∫–ª–æ–Ω—è–µ—Ç—Å—è. üî•',
                scenario2Btn: '–†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å (100 –æ–≥–Ω–µ–π)',
                scenario3Title: '–û—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–æ–ª–∏—Ü–µ–π—Å–∫–æ–π',
                scenario3Desc: '–û–Ω–∞ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Ç–µ–±—è –≤ –≥–ª—É—à–∏, –ø—Ä–∞–≤ –Ω–µ—Ç ‚Äî –µ—ë —É—Ö–º—ã–ª–∫–∞ –æ–±–µ—â–∞–µ—Ç —Ä–∞–∑–≤—Ä–∞—Ç–Ω–æ–µ –Ω–∞–∫–∞–∑–∞–Ω–∏–µ! üíã',
                scenario3Btn: '–†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å (100 –æ–≥–Ω–µ–π)',
                scenario4Title: '–ü–æ–º–æ—â—å –ø–æ–¥—Ä—É–≥–µ',
                scenario4Desc: '–ï—ë –∫–æ–º–ø—å—é—Ç–µ—Ä –∑–∞–≤–∏—Å, –∞ —Ä–æ–±–∫–∏–µ –≤–∑–≥–ª—è–¥—ã –ø—Ä–µ–≤—Ä–∞—â–∞—é—Ç—Å—è –≤ –∂–∞—Ä–∫–∏–µ –Ω–∞–º—ë–∫–∏, –∫–æ–≥–¥–∞ —Ç—ã –Ω–∞–∫–ª–æ–Ω—è–µ—à—å—Å—è –±–ª–∏–∂–µ. üòè',
                scenario4Btn: '–†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å (100 –æ–≥–Ω–µ–π)',
                detailsHeader: '–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –ø—Ä–µ–º–∏—É–º–∞',
                subscriptionsDesc: '–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –ø—Ä–µ–º–∏—É–º–∞ üî•‚ú®\n–ù–æ–≤—ã–π –ª–∏–º–∏—Ç: 50 —Ñ–æ—Ç–æ/–¥–µ–Ω—å + –ë–µ–∑–ª–∏–º–∏—Ç–Ω—ã–π —á–∞—Ç! üí¨üíÉ\n–û–¥–µ–≤–∞–π—Å—è –ª—É—á—à–µ üåü\n–û—Ç–≤–µ—á–∞–π –±—ã—Å—Ç—Ä–µ–µ ‚ö°\n–£–ª—É—á—à–µ–Ω–Ω–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π üé®\n–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ —Å—Ü–µ–Ω–∞—Ä–∏—è–º üöÄ',
                subscriptionsDescDeluxe: '–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –ø—Ä–µ–º–∏—É–º–∞ üî•‚ú®\n–ù–æ–≤—ã–π –ª–∏–º–∏—Ç: –ë–µ–∑–ª–∏–º–∏—Ç —Ñ–æ—Ç–æ/–¥–µ–Ω—å + –ë–µ–∑–ª–∏–º–∏—Ç–Ω—ã–π —á–∞—Ç! üí¨üíÉ\n–û–¥–µ–≤–∞–π—Å—è –ª—É—á—à–µ üåü\n–û—Ç–≤–µ—á–∞–π –±—ã—Å—Ç—Ä–µ–µ ‚ö°\n–£–ª—É—á—à–µ–Ω–Ω–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π üé®\n–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ —Å—Ü–µ–Ω–∞—Ä–∏—è–º üöÄ',
                sub1Day: '1 –¥–µ–Ω—å',
                sub3Days: '3 –¥–Ω—è',
                sub1Week: '1 –Ω–µ–¥–µ–ª—è',
                sub1Month: '1 –º–µ—Å—è—Ü +30üî• –æ–≥–Ω–µ–π',
                sub3Months: '3 –º–µ—Å—è—Ü–∞ +100üî• –æ–≥–Ω–µ–π',
                subForever: '–ù–∞–≤—Å–µ–≥–¥–∞ +200üî• –æ–≥–Ω–µ–π',
                subDeluxe: '–î–µ–ª—é–∫—Å (–±–µ–∑–ª–∏–º–∏—Ç) +500üî• –æ–≥–Ω–µ–π',
                buyBtn: '–ö—É–ø–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É',
                buyBtnSmallPack: '–ö—É–ø–∏—Ç—å –∑–∞ $6',
                buyBtnMediumPack: '–ö—É–ø–∏—Ç—å –∑–∞ $12',
                buyBtnLargePack: '–ö—É–ø–∏—Ç—å –∑–∞ $25',
                buyBtnMegaPack: '–ö—É–ø–∏—Ç—å –∑–∞ $45',
                currencyBalance: '–í–∞—à —Ç–µ–∫—É—â–∏–π –±–∞–ª–∞–Ω—Å: ',
                smallPack: '–ú–∞–ª—ã–π –Ω–∞–±–æ—Ä',
                smallPackDesc: '–ë—ã—Å—Ç—Ä—ã–π –±—É—Å—Ç —Å 100üî• –æ–≥–Ω–µ–π! üöÄ',
                mediumPack: '–°—Ä–µ–¥–Ω–∏–π –Ω–∞–±–æ—Ä',
                mediumPackDesc: '–†–∞–∑–æ–∂–≥–∏ —Ñ–∞–Ω—Ç–∞–∑–∏–∏ —Å 200üî• –æ–≥–Ω–µ–π! üí•',
                largePack: '–ë–æ–ª—å—à–æ–π –Ω–∞–±–æ—Ä',
                largePackDesc: '–†–∞—Å–∫—Ä–æ–π –∂–∞—Ä —Å 500üî• –æ–≥–Ω–µ–π! üî•',
                megaPack: '–ú–µ–≥–∞ –Ω–∞–±–æ—Ä',
                megaPackDesc: '–í—ã–ª–æ–∂–∏—Å—å –Ω–∞ –ø–æ–ª–Ω—É—é —Å 1000üî• –æ–≥–Ω–µ–π! üåü',
                languageTitle: '–í—ã–±–µ—Ä–∏—Ç–µ —è–∑—ã–∫',
                closeBtn: '–ó–∞–∫—Ä—ã—Ç—å',
                confirmUnlock: '–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫—É',
                notEnoughFires: '–£ —Ç–µ–±—è –Ω–µ —Ö–≤–∞—Ç–∞–µ—Ç!',
                missingFires: amount => `–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ ${amount} –æ–≥–Ω–µ–π!`,
                buyFiresBtn: '–î–æ–∫—É–ø–∏—Ç—å',
                cancelBtn: '–û—Ç–º–µ–Ω–∞',
                scenarioUnlock: scenarioId => `–°—Ü–µ–Ω–∞—Ä–∏–π "${['–°–ø—è—â–∏–π —Ä–µ–ø–µ—Ç–∏—Ç–æ—Ä', '–£—á–∏—Ç–µ–ª—å–Ω–∏—Ü–∞ –ø–æ—Å–ª–µ —É—Ä–æ–∫–æ–≤', '–û—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–æ–ª–∏—Ü–µ–π—Å–∫–æ–π', '–ü–æ–º–æ—â—å –ø–æ–¥—Ä—É–≥–µ'][scenarioId - 1]}" —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω! –ù–∞—Å–ª–∞–∂–¥–∞–π—Å—è! üòè`,
                buyTokensMsg: (amount, price) => `–í—ã –∫—É–ø–∏–ª–∏ ${amount} –æ–≥–Ω–µ–π –∑–∞ $${price}! –ü–æ–≥—Ä—É–∂–∞–π—Å—è! üòà`,
                buySubMsg: (price, bonus) => `–ü–æ–¥–ø–∏—Å–∫–∞ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–∞ –∑–∞ $${price}! ${bonus > 0 ? `+${bonus} –æ–≥–Ω–µ–π –±–æ–Ω—É—Å–æ–º! ` : ''}–ù–∞—Å–ª–∞–∂–¥–∞–π—Å—è! üíã`,
                maxTokensMsg: max => `–î–æ—Å—Ç–∏–≥–Ω—É—Ç –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –ª–∏–º–∏—Ç –≤ ${max} –æ–≥–Ω–µ–π!`,
                languageSetMsg: '–Ø–∑—ã–∫ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –Ω–∞ –†—É—Å—Å–∫–∏–π!'
            }
        };

        function updateUI() {
            tokens = userData[currentUser].fires;
            subscriptionDaysLeft = userData[currentUser].subscriptionDaysLeft;
            photoLimit = userData[currentUser].photoLimit;
            dailyPhotoCount = userData[currentUser].dailyPhotoCount;

            document.getElementById('tokenCount').innerText = tokens;
            document.getElementById('currencyBalanceText').innerText = `${translations[language].currencyBalance}${tokens} Fires`;
            if (subscriptionDaysLeft > 0) {
                document.getElementById('subscriptionStatus').innerText = `Active: ${subscriptionDaysLeft} day${subscriptionDaysLeft === 1 ? '' : 's'} left`;
                document.getElementById('limitsStatus').classList.remove('hidden');
                document.getElementById('limitsStatus').innerText = `Limits: ${photoLimit === Infinity ? 'Unlimited' : photoLimit} photos/day, Unlimited messages`;
            } else {
                document.getElementById('subscriptionStatus').innerText = language === 'en' ? 'No active subscription' : '–ù–µ—Ç –∞–∫—Ç–∏–≤–Ω–æ–π –ø–æ–¥–ø–∏—Å–∫–∏';
                document.getElementById('limitsStatus').classList.add('hidden');
            }

            const deluxeSelected = selectedPlan === 7;
            document.getElementById('subscriptionsDesc').innerHTML = (deluxeSelected ? translations[language].subscriptionsDescDeluxe : translations[language].subscriptionsDesc)
                .split('\n')
                .map(line => `<p>${line}</p>`)
                .join('');

            updateLanguageButton();
            updateSubscriptionHighlight();
        }

        document.getElementById('addTokensBtn').addEventListener('click', () => {
            showSection('currencySection');
        });

        function buyTokens(amount, price) {
            if (tokens + amount > maxTokens) {
                showAlert(translations[language].maxTokensMsg(maxTokens));
                return;
            }
            userData[currentUser].fires += amount;
            updateUI();
            showAlert(translations[language].buyTokensMsg(amount, price));
        }

        function toggleLanguage() {
            language = language === 'en' ? 'ru' : 'en';
            updateLanguage();
            updateLanguageButton();
            showAlert(translations[language].languageSetMsg);
        }

        function updateLanguageButton() {
            const flag = language === 'en' ? 'üá¨üáß' : 'üá∑üá∫';
            const text = language === 'en' ? 'English' : '–†—É—Å—Å–∫–∏–π';
            document.getElementById('currentFlag').innerText = flag;
            document.getElementById('languageText').innerText = text;
        }

        function setLanguage(lang) {
            language = lang;
            updateLanguage();
            updateLanguageButton();
            closeLanguageModal();
            showAlert(translations[language].languageSetMsg);
        }

        function closeLanguageModal() {
            document.getElementById('languageModal').classList.add('hidden');
        }

        function updateLanguage() {
            document.getElementById('welcomeTitle').innerText = translations[language].welcome;
            document.getElementById('scenariosTitle').innerText = translations[language].scenarios;
            document.getElementById('subscriptionsTitle').innerText = translations[language].subscriptions;
            document.getElementById('detailsHeader').innerText = translations[language].detailsHeader;
            const deluxeSelected = selectedPlan === 7;
            document.getElementById('subscriptionsDesc').innerHTML = (deluxeSelected ? translations[language].subscriptionsDescDeluxe : translations[language].subscriptionsDesc)
                .split('\n')
                .map(line => `<p>${line}</p>`)
                .join('');
            document.getElementById('currencyTitle').innerText = translations[language].currency;
            document.getElementById('scenariosBtnText').innerText = translations[language].scenarios;
            document.getElementById('subscriptionsBtnText').innerText = translations[language].subscriptions;
            document.getElementById('currencyBtnText').innerText = translations[language].currency;

            document.getElementById('scenario1Title').innerText = translations[language].scenario1Title;
            document.getElementById('scenario1Desc').innerText = translations[language].scenario1Desc;
            document.getElementById('scenario1Btn').innerText = translations[language].scenario1Btn;
            document.getElementById('scenario2Title').innerText = translations[language].scenario2Title;
            document.getElementById('scenario2Desc').innerText = translations[language].scenario2Desc;
            document.getElementById('scenario2Btn').innerText = translations[language].scenario2Btn;
            document.getElementById('scenario3Title').innerText = translations[language].scenario3Title;
            document.getElementById('scenario3Desc').innerText = translations[language].scenario3Desc;
            document.getElementById('scenario3Btn').innerText = translations[language].scenario3Btn;
            document.getElementById('scenario4Title').innerText = translations[language].scenario4Title;
            document.getElementById('scenario4Desc').innerText = translations[language].scenario4Desc;
            document.getElementById('scenario4Btn').innerText = translations[language].scenario4Btn;

            document.getElementById('sub1Day').innerText = translations[language].sub1Day;
            document.getElementById('sub3Days').innerText = translations[language].sub3Days;
            document.getElementById('sub1Week').innerText = translations[language].sub1Week;
            document.getElementById('sub1Month').innerText = translations[language].sub1Month;
            document.getElementById('sub3Months').innerText = translations[language].sub3Months;
            document.getElementById('subForever').innerText = translations[language].subForever;
            document.getElementById('subDeluxe').innerText = translations[language].subDeluxe;
            document.getElementById('buyBtnText').innerText = translations[language].buyBtn;

            document.getElementById('currencyBalanceText').innerText = `${translations[language].currencyBalance}${tokens} Fires`;
            document.getElementById('smallPack').innerText = translations[language].smallPack;
            document.getElementById('smallPackDesc').innerText = translations[language].smallPackDesc;
            document.getElementById('mediumPack').innerText = translations[language].mediumPack;
            document.getElementById('mediumPackDesc').innerText = translations[language].mediumPackDesc;
            document.getElementById('largePack').innerText = translations[language].largePack;
            document.getElementById('largePackDesc').innerText = translations[language].largePackDesc;
            document.getElementById('megaPack').innerText = translations[language].megaPack;
            document.getElementById('megaPackDesc').innerText = translations[language].megaPackDesc;
            document.getElementById('buyBtnSmallPack').innerText = translations[language].buyBtnSmallPack;
            document.getElementById('buyBtnMediumPack').innerText = translations[language].buyBtnMediumPack;
            document.getElementById('buyBtnLargePack').innerText = translations[language].buyBtnLargePack;
            document.getElementById('buyBtnMegaPack').innerText = translations[language].buyBtnMegaPack;

            document.getElementById('languageTitle').innerText = translations[language].languageTitle;
            document.getElementById('closeBtnText').innerText = translations[language].closeBtn;
        }

        function showSection(sectionId) {
            const sections = ['scenariosSection', 'subscriptionsSection', 'currencySection'];
            sections.forEach(sec => document.getElementById(sec).classList.add('hidden'));
            document.getElementById(sectionId).classList.remove('hidden');
        }

        function selectScenario(id) {
            const requiredTokens = 100;
            if (tokens < requiredTokens) {
                const missing = requiredTokens - tokens;
                document.getElementById('confirmTitle').innerText = translations[language].notEnoughFires;
                document.getElementById('confirmText').innerText = translations[language].missingFires(missing);
                document.getElementById('confirmBtn').innerText = translations[language].buyFiresBtn;
                document.getElementById('confirmBtn').onclick = () => {
                    closeConfirmModal();
                    showSection('currencySection');
                };
                document.getElementById('cancelBtn').innerText = translations[language].cancelBtn;
                document.getElementById('cancelBtn').onclick = closeConfirmModal;
                document.getElementById('confirmModal').classList.remove('hidden');
            } else {
                document.getElementById('confirmTitle').innerText = translations[language].confirmUnlock;
                document.getElementById('confirmText').innerText = language === 'en' ?
                    `Unlock "${translations[language]['scenario' + id + 'Title']}" for 100 Fires?` :
                    `–†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å "${translations[language]['scenario' + id + 'Title']}" –∑–∞ 100 –æ–≥–Ω–µ–π?`;
                document.getElementById('confirmBtn').innerText = language === 'en' ? 'Confirm' : '–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å';
                document.getElementById('confirmBtn').onclick = () => {
                    userData[currentUser].fires -= 100;
                    scenarios.push(id);
                    updateUI();
                    closeConfirmModal();
                    showAlert(translations[language].scenarioUnlock(id));
                };
                document.getElementById('cancelBtn').innerText = translations[language].cancelBtn;
                document.getElementById('cancelBtn').onclick = closeConfirmModal;
                document.getElementById('confirmModal').classList.remove('hidden');
            }
        }

        function selectSubscription(planId) {
            selectedPlan = selectedPlan === planId ? null : planId;
            updateSubscriptionHighlight();
        }

        function updateSubscriptionHighlight() {
            const subCards = document.querySelectorAll('#subscriptionsSection .sub-card');
            subCards.forEach((card, index) => {
                if (index + 1 === selectedPlan) {
                    card.classList.add('selected');
                } else {
                    card.classList.remove('selected');
                }
            });
        }

        function buySelectedSubscription() {
            if (!selectedPlan) {
                showAlert(language === 'en' ? 'Please select a subscription plan!' : '–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ –ø–ª–∞–Ω –ø–æ–¥–ø–∏—Å–∫–∏!');
                return;
            }

            const plans = [
                { days: 1, price: 2, bonusFires: 0 },
                { days: 3, price: 5, bonusFires: 0 },
                { days: 7, price: 13, bonusFires: 0 },
                { days: 30, price: 25, bonusFires: 30 },
                { days: 90, price: 70, bonusFires: 100 },
                { days: 0, price: 50, bonusFires: 200 },
                { days: -1, price: 100, bonusFires: 500 }
            ];

            const plan = plans[selectedPlan - 1];
            buySubscription(plan.days, plan.price, plan.bonusFires, selectedPlan);
            selectedPlan = null;
            updateSubscriptionHighlight();
        }

        function buySubscription(days, price, bonusFires, planId) {
            if (days === 0) {
                userData[currentUser].subscriptionDaysLeft = 9999;
                userData[currentUser].fires += bonusFires;
                userData[currentUser].photoLimit = 50;
            } else if (days === -1) {
                userData[currentUser].subscriptionDaysLeft = 99999;
                userData[currentUser].photoLimit = Infinity;
                userData[currentUser].fires += bonusFires;
            } else {
                userData[currentUser].subscriptionDaysLeft = days;
                userData[currentUser].photoLimit = 50;
                userData[currentUser].fires += bonusFires;
            }
            updateUI();
            showAlert(translations[language].buySubMsg(price, bonusFires));
        }

        function closeConfirmModal() {
            document.getElementById('confirmModal').classList.add('hidden');
        }

        function showAlert(message) {
            tg.showAlert(message);
        }

        updateUI();
        updateLanguage();
        showSection('scenariosSection');
    </script>
</body>
</html>
